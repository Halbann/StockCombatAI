@PART[*]:HAS[@MODULE[ModulePartFirework]]
{
  	%MODULE[ModuleLauncherAnimation]
 	{
		moduleName = ModuleLauncherAnimation
		spinTime = 0.1
		spinDegrees = -36
  	}
	%MODULE[ModuleAnimateHeat]
    {
		name = ModuleAnimateHeat
		ThermalAnim = FireworksHeat
    }
	%MODULE[ModuleFireworkFixer]
	{
		name = ModuleFireworkFixer
		flareSize = 0.2
		flareLightRange = 20
		flareLightIntensity = 1.5
		shotHeat = 20
		shellLifetime = 30
	}
}

@PART[fireworksLauncherSmall]
{
	// The smaller launcher loses heat much faster than the big launcher (too fast).
	// Add more heat.
	@MODULE[ModuleFireworkFixer]
	{
		@shotHeat = 40
	}

  	%MODULE[ModuleLauncherReload]
 	{
   	 	moduleName = ModuleLauncherReload
		defaultMagazine = KCSfireworkShells8
  	}

	%MODULE[ModuleInventoryPart]
    {
        name = ModuleInventoryPart
        InventorySlots = 1
        packedVolumeLimit = 60
		DEFAULTPARTS
		{
			name = KCSfireworkShells8
		}
    }
	
	!MODEL {}
	MODEL
	{
		model = KCS/Parts/Fireworks/fireworksLauncherSmall
	}
	
	%EFFECTS
	{
		muzzleFire
		{
			PREFAB_PARTICLE
			{
				prefabName = fx_exhaustSparks_flameout_2
				transformName = muzzle
				oneShot = true
			}
			// AUDIO
			// {
				// channel = Ship
				// clip = sound_explosion_low
				// volume = 1.0
				// pitch = 2.0
				// loop = false
			// }
		}
	}
}

@PART[fireworksLauncherBig]
{
  	%MODULE[ModuleLauncherReload]
 	{
   	 	moduleName = ModuleLauncherReload
		defaultMagazine = KCSfireworkShells32
  	}

	%MODULE[ModuleInventoryPart]
    {
        name = ModuleInventoryPart
        InventorySlots = 1
        packedVolumeLimit = 240
		DEFAULTPARTS
		{
			name = KCSfireworkShells32
		}
    }
	
	!MODEL {}
	MODEL
	{
		model = KCS/Parts/Fireworks/fireworksLauncherBig
	}
}

// Modify TU to use our new textures (TU is not required).
// We could disable the material or switcher but that breaks the switcher's UI.
@KSP_TEXTURE_SET[Stock_Default_fireworksLaunchers]:NEEDS[TURD&!Restock]:AFTER[TURD]
{
	!MATERIAL {}
	MATERIAL
	{	
		mode = create
		shader = KSP/Emissive/Bumped Specular
		texture = _MainTex,KCS/Parts/Fireworks/fireworks_launcher_big
		texture = _BumpMap,Squad/Parts/Utility/Fireworks/Assets/fireworks_launcher_big 1
		texture = _Emissive,KCS/Parts/Fireworks/fireworks_launcher_emissive
	}
}

// Remove the switchers entirely.
// @PART[fireworksLauncherBig,fireworksLauncherSmall]:NEEDS[TURD&!Restock]:AFTER[TURD]
// {
	// !MODULE[KSPTextureSwitch] {}
	// !MODULE[SSTURecolorGUI] {}
// }